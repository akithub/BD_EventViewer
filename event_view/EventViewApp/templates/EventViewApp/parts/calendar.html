{% load static %}
<link href="{% static 'lib/fullcalendar-5.3.2/lib/main.css' %}" rel='stylesheet' />
<script src="{% static 'lib/fullcalendar-5.3.2/lib/main.js' %}"></script>
<div class="w-75 mx-auto">
    <div class="poster">
        <div id='calendar'></div>
    </div>
    {{ event|json_script:"event-data" }}
</div>
<script>
    eventData = JSON.parse(document.getElementById('event-data').textContent);
    console.log(eventData);
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');
        var dt = new Date();
        var y = dt.getFullYear();
        var m = ("00" + (dt.getMonth() + 1)).slice(-2);
        var d = ("00" + dt.getDate()).slice(-2);

        var calendar = new FullCalendar.Calendar(calendarEl, {
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            initialDate: y + "-" + m + "-" + d,
            navLinks: true, // can click day/week names to navigate views
            selectable: true,
            selectMirror: true,
            select: function (arg) {
                var title = prompt('Event Title:');
                if (title) {
                    calendar.addEvent({
                        title: title,
                        start: arg.start,
                        end: arg.end,
                        allDay: arg.allDay
                    })
                }
                calendar.unselect()
            },
            eventClick: function (arg) {
                if (confirm('Are you sure you want to delete this event?')) {
                    arg.event.remove()
                }
            },
            editable: true,
            dayMaxEvents: false, // allow "more" link when too many events
            events: eventData
        });

        calendar.render();
    });

</script>
<style>
    #calendar {
        max-width: 1100px;
        margin: 0 auto;
    }
</style>